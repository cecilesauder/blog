---
title: Scraping Umbrella Academy's scripts
author: C√©cile Sauder
date: '2019-02-22'
topics:
  - scraping
  - umbrella academy
  - series
tags:
  - rvest
slug: umbrella-academy
header: "https://m.media-amazon.com/images/I/81pJBOc71wL._SS500_.jpg"
---



<div id="why-umbrella-academy" class="section level1">
<h1>Why Umbrella Academy ?</h1>
<p>I‚Äôm a big fan of <a href="https://en.wikipedia.org/wiki/Ellen_Page">Ellen Page</a> ! I really love her üòç. <a href="https://www.imdb.com/title/tt0467406/">Juno</a> is one of my favorite movies, no, actually it‚Äôs even my favorite movie. Besides, the soundtrack is my ‚è∞ üé∂.<br />
So I had to watch this series, and it is awesome ! (Okay, maybe I‚Äôm a little biased). I‚Äôve only seen the first five episodes so far. I‚Äôm taking my time because I know I‚Äôll be super sad üò≠ when I‚Äôm done with the season. I‚Äôll try not to spoil myself too much by analyzing the scripts‚Ä¶ challenging !</p>
<p align="center">
<img src="https://tel.img.pmdstatic.net/fit/http.3A.2F.2Fprd2-bone-image.2Es3-website-eu-west-1.2Eamazonaws.2Ecom.2Ftel.2F2018.2F10.2F08.2Ffc869c14-0bff-4651-aa98-37775ce1695f.2Ejpeg/540x400/quality/80/thumbnail.jpeg" />
</p>
</div>
<div id="scraping-the-scripts" class="section level1">
<h1>Scraping the scripts</h1>
<p>To start, load the essential packages <strong>tidyverse</strong> to do everything tidy, <strong>rvest</strong> to scrap web pages and <strong>glue</strong> to make tidy paste.</p>
<pre class="r"><code>library(tidyverse)
library(rvest)
library(glue)</code></pre>
<p>Then, <a href="http://lmgtfy.com/?q=script+umbrella+academy">find a web page with the scripts of the series</a>, and put the url in <code>url</code>.</p>
<pre class="r"><code>url &lt;- &#39;https://www.springfieldspringfield.co.uk/episode_scripts.php?tv-show=the-umbrella-academy-2019&amp;season=1&#39;</code></pre>
<p align="center">
<img src="https://media.giphy.com/media/3fibASpOsR4s94M1v4/giphy.gif" />
</p>
<p>I played a little with <a href="https://selectorgadget.com/">SelectorGadget</a> to find the class of what I wanted, <code>.season-episode-title</code> seemed a good one, so let‚Äôs see what it contains :</p>
<pre class="r"><code>url %&gt;%
  read_html() %&gt;%
  html_nodes(&#39;.season-episode-title&#39;)</code></pre>
<pre><code>## {xml_nodeset (10)}
##  [1] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...
##  [2] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...
##  [3] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...
##  [4] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...
##  [5] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...
##  [6] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...
##  [7] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...
##  [8] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...
##  [9] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...
## [10] &lt;a href=&quot;view_episode_scripts.php?tv-show=the-umbrella-academy-2019 ...</code></pre>
<p>Good, we can get episodes titles and <code>href</code> attribute gives the end the url of each episode, we just have to paste it to ‚Äú<a href="https://www.springfieldspringfield.co.uk/" class="uri">https://www.springfieldspringfield.co.uk/</a>‚Äù.</p>
<pre class="r"><code>#titles of the episodes
episodes_titles &lt;- url %&gt;%
  read_html() %&gt;%
  html_nodes(&#39;.season-episode-title&#39;) %&gt;%
  html_text()

#url of the episodes
episodes_urls &lt;- url %&gt;%
  read_html() %&gt;%
  html_nodes(&#39;.season-episode-title&#39;) %&gt;%
  html_attr(&quot;href&quot;) %&gt;%
  map(~glue(&quot;https://www.springfieldspringfield.co.uk/{.}&quot;)) </code></pre>
<p>If you go on <a href="https://www.springfieldspringfield.co.uk/view_episode_scripts.php?tv-show=the-umbrella-academy-2019&amp;episode=s01e01">the web page of the first episode for example</a>, you‚Äôll note that the script is in the class <code>.scrolling-script-container</code>. So I made a little function to get the script of an episode, then I applied it to the episodes urls list with <code>map</code>.</p>
<pre class="r"><code>#function to get the script of an episode
get_script &lt;- function(url){
  url %&gt;%
    read_html() %&gt;%
    html_nodes(&quot;.scrolling-script-container&quot;) %&gt;%
    html_text()
}

episodes_scripts &lt;- episodes_urls %&gt;%
  map(~get_script(.))</code></pre>
<p>Then I put titles and scripts in a tibble.</p>
<pre class="r"><code>df &lt;- tibble(episodes_titles, episodes_scripts)</code></pre>
<p>Now we have a tidy data frame with all the scripts‚Ä¶</p>
<p align="center">
<img src="https://media.giphy.com/media/28FpALDPHljpalhdRa/giphy.gif" />
</p>
<p>Yes, that‚Äôs all for today, tomorrow I‚Äôll analyze them, if üë∂ wants it üòÄ</p>
</div>
